{"version":3,"file":"index.es.js","sources":["../../../nodes/basic-marks/dist/index.es.js","../../../nodes/horizontal-rule/dist/index.es.js","../src/deserializer/utils/deserializeMd.ts","../src/deserializer/utils/filterBreakLines.ts","../src/deserializer/createDeserializeMdPlugin.ts"],"sourcesContent":["import { createPluginFactory, someHtmlElement, onKeyDownToggleMark, findHtmlParentElement } from '@udecode/plate-core';\n\nconst MARK_BOLD = 'bold';\n/**\n * Enables support for bold formatting\n */\n\nconst createBoldPlugin = createPluginFactory({\n  key: MARK_BOLD,\n  isLeaf: true,\n  deserializeHtml: {\n    rules: [{\n      validNodeName: ['STRONG', 'B']\n    }, {\n      validStyle: {\n        fontWeight: ['600', '700', 'bold']\n      }\n    }],\n    query: el => !someHtmlElement(el, node => node.style.fontWeight === 'normal')\n  },\n  handlers: {\n    onKeyDown: onKeyDownToggleMark\n  },\n  options: {\n    hotkey: 'mod+b'\n  }\n});\n\nconst MARK_CODE = 'code';\n/**\n * Enables support for code formatting\n */\n\nconst createCodePlugin = createPluginFactory({\n  key: MARK_CODE,\n  isLeaf: true,\n  deserializeHtml: {\n    rules: [{\n      validNodeName: ['CODE']\n    }, {\n      validStyle: {\n        wordWrap: 'break-word'\n      }\n    }, {\n      validStyle: {\n        fontFamily: 'Consolas'\n      }\n    }],\n\n    query(el) {\n      const blockAbove = findHtmlParentElement(el, 'P');\n      if ((blockAbove === null || blockAbove === void 0 ? void 0 : blockAbove.style.fontFamily) === 'Consolas') return false;\n      return !findHtmlParentElement(el, 'PRE');\n    }\n\n  },\n  handlers: {\n    onKeyDown: onKeyDownToggleMark\n  },\n  options: {\n    hotkey: 'mod+e'\n  }\n});\n\nconst MARK_ITALIC = 'italic';\n/**\n * Enables support for italic formatting.\n */\n\nconst createItalicPlugin = createPluginFactory({\n  key: MARK_ITALIC,\n  isLeaf: true,\n  handlers: {\n    onKeyDown: onKeyDownToggleMark\n  },\n  options: {\n    hotkey: 'mod+i'\n  },\n  deserializeHtml: {\n    rules: [{\n      validNodeName: ['EM', 'I']\n    }, {\n      validStyle: {\n        fontStyle: 'italic'\n      }\n    }],\n    query: el => !someHtmlElement(el, node => node.style.fontStyle === 'normal')\n  }\n});\n\nconst MARK_STRIKETHROUGH = 'strikethrough';\n/**\n * Enables support for strikethrough formatting.\n */\n\nconst createStrikethroughPlugin = createPluginFactory({\n  key: MARK_STRIKETHROUGH,\n  isLeaf: true,\n  handlers: {\n    onKeyDown: onKeyDownToggleMark\n  },\n  options: {\n    hotkey: 'mod+shift+x'\n  },\n  deserializeHtml: {\n    rules: [{\n      validNodeName: ['S', 'DEL', 'STRIKE']\n    }, {\n      validStyle: {\n        textDecoration: 'line-through'\n      }\n    }],\n    query: el => !someHtmlElement(el, node => node.style.textDecoration === 'none')\n  }\n});\n\nconst MARK_SUBSCRIPT$1 = 'subscript';\nconst MARK_SUPERSCRIPT$1 = 'superscript';\n/**\n * Enables support for subscript formatting.\n */\n\nconst createSubscriptPlugin = createPluginFactory({\n  key: MARK_SUBSCRIPT$1,\n  isLeaf: true,\n  handlers: {\n    onKeyDown: onKeyDownToggleMark\n  },\n  options: {\n    hotkey: 'mod+,',\n    clear: MARK_SUPERSCRIPT$1\n  },\n  deserializeHtml: {\n    rules: [{\n      validNodeName: ['SUB']\n    }, {\n      validStyle: {\n        verticalAlign: 'sub'\n      }\n    }]\n  }\n});\n\nconst MARK_SUPERSCRIPT = 'superscript';\nconst MARK_SUBSCRIPT = 'subscript';\n/**\n * Enables support for superscript formatting.\n */\n\nconst createSuperscriptPlugin = createPluginFactory({\n  key: MARK_SUPERSCRIPT,\n  isLeaf: true,\n  handlers: {\n    onKeyDown: onKeyDownToggleMark\n  },\n  options: {\n    hotkey: 'mod+.',\n    clear: MARK_SUBSCRIPT\n  },\n  deserializeHtml: {\n    rules: [{\n      validNodeName: ['SUP']\n    }, {\n      validStyle: {\n        verticalAlign: 'super'\n      }\n    }]\n  }\n});\n\nconst MARK_UNDERLINE = 'underline';\n/**\n * Enables support for underline formatting.\n */\n\nconst createUnderlinePlugin = createPluginFactory({\n  key: MARK_UNDERLINE,\n  isLeaf: true,\n  handlers: {\n    onKeyDown: onKeyDownToggleMark\n  },\n  options: {\n    hotkey: 'mod+u'\n  },\n  deserializeHtml: {\n    rules: [{\n      validNodeName: ['U']\n    }, {\n      validStyle: {\n        textDecoration: ['underline']\n      }\n    }],\n    query: el => !someHtmlElement(el, node => node.style.textDecoration === 'none')\n  }\n});\n\n/**\n * Enables support for basic marks:\n * - Bold\n * - Code\n * - Italic\n * - Strikethrough\n * - Subscript\n * - Superscript\n * - Underline\n */\n\nconst createBasicMarksPlugin = createPluginFactory({\n  key: 'basicMarks',\n  plugins: [createBoldPlugin(), createCodePlugin(), createItalicPlugin(), createStrikethroughPlugin(), createSubscriptPlugin(), createSuperscriptPlugin(), createUnderlinePlugin()]\n});\n\nexport { MARK_BOLD, MARK_CODE, MARK_ITALIC, MARK_STRIKETHROUGH, MARK_SUBSCRIPT$1 as MARK_SUBSCRIPT, MARK_SUPERSCRIPT, MARK_UNDERLINE, createBasicMarksPlugin, createBoldPlugin, createCodePlugin, createItalicPlugin, createStrikethroughPlugin, createSubscriptPlugin, createSuperscriptPlugin, createUnderlinePlugin };\n//# sourceMappingURL=index.es.js.map\n","import { createPluginFactory } from '@udecode/plate-core';\n\nconst ELEMENT_HR = 'hr';\nconst createHorizontalRulePlugin = createPluginFactory({\n  key: ELEMENT_HR,\n  isElement: true,\n  isVoid: true,\n  deserializeHtml: {\n    rules: [{\n      validNodeName: 'HR'\n    }]\n  }\n});\n\nexport { ELEMENT_HR, createHorizontalRulePlugin };\n//# sourceMappingURL=index.es.js.map\n","import {\n  MARK_BOLD,\n  MARK_CODE,\n  MARK_ITALIC,\n  MARK_STRIKETHROUGH,\n} from '@udecode/plate-basic-marks';\nimport { ELEMENT_BLOCKQUOTE } from '@udecode/plate-block-quote';\nimport { ELEMENT_CODE_BLOCK } from '@udecode/plate-code-block';\nimport { getPluginType, PlateEditor, Value } from '@udecode/plate-core';\nimport {\n  ELEMENT_H1,\n  ELEMENT_H2,\n  ELEMENT_H3,\n  ELEMENT_H4,\n  ELEMENT_H5,\n  ELEMENT_H6,\n} from '@udecode/plate-heading';\nimport { ELEMENT_HR } from '@udecode/plate-horizontal-rule';\nimport { ELEMENT_LINK } from '@udecode/plate-link';\nimport { ELEMENT_LI, ELEMENT_OL, ELEMENT_UL } from '@udecode/plate-list';\nimport { ELEMENT_PARAGRAPH } from '@udecode/plate-paragraph';\nimport remarkParse from 'remark-parse';\nimport slate from 'remark-slate';\nimport { unified } from 'unified';\n\n/**\n * Deserialize content from Markdown format to Slate format.\n * `editor` needs\n */\nexport const deserializeMd = <V extends Value>(\n  editor: PlateEditor<V>,\n  data: string\n) => {\n  const tree: any = unified()\n    .use(remarkParse)\n    .use(slate, {\n      nodeTypes: {\n        paragraph: getPluginType(editor, ELEMENT_PARAGRAPH),\n        block_quote: getPluginType(editor, ELEMENT_BLOCKQUOTE),\n        link: getPluginType(editor, ELEMENT_LINK),\n        inline_code_mark: getPluginType(editor, MARK_CODE),\n        emphasis_mark: getPluginType(editor, MARK_ITALIC),\n        strong_mark: getPluginType(editor, MARK_BOLD),\n        delete_mark: getPluginType(editor, MARK_STRIKETHROUGH),\n        // FIXME: underline, subscript superscript not yet supported by remark-slate\n        // underline: getPluginType(editor, MARK_UNDERLINE),\n        // subscript: getPluginType(editor, MARK_SUBSCRIPT),\n        // superscript: getPluginType(editor, MARK_SUPERSCRIPT),\n        code_block: getPluginType(editor, ELEMENT_CODE_BLOCK),\n        thematic_break: getPluginType(editor, ELEMENT_HR),\n        ul_list: getPluginType(editor, ELEMENT_UL),\n        ol_list: getPluginType(editor, ELEMENT_OL),\n        listItem: getPluginType(editor, ELEMENT_LI),\n        heading: {\n          1: getPluginType(editor, ELEMENT_H1),\n          2: getPluginType(editor, ELEMENT_H2),\n          3: getPluginType(editor, ELEMENT_H3),\n          4: getPluginType(editor, ELEMENT_H4),\n          5: getPluginType(editor, ELEMENT_H5),\n          6: getPluginType(editor, ELEMENT_H6),\n        },\n      },\n      linkDestinationKey: 'url',\n    })\n    .processSync(data);\n\n  return tree.result;\n};\n","export function filterBreaklines(item: any): boolean {\n  return !item.text;\n}\n","import { createPluginFactory, isUrl } from '@udecode/plate-core';\nimport { deserializeMd } from './utils';\n\nexport const KEY_DESERIALIZE_MD = 'deserializeMd';\n\nexport const createDeserializeMdPlugin = createPluginFactory({\n  key: KEY_DESERIALIZE_MD,\n  then: (editor) => ({\n    editor: {\n      insertData: {\n        format: 'text/plain',\n        query: ({ data, dataTransfer }) => {\n          const htmlData = dataTransfer.getData('text/html');\n          if (htmlData) return false;\n\n          const { files } = dataTransfer;\n          if (!files?.length) {\n            // if content is simply a URL pass through to not break LinkPlugin\n            if (isUrl(data)) {\n              return false;\n            }\n          }\n          return true;\n        },\n        getFragment: ({ data }) => deserializeMd(editor, data),\n      },\n    },\n  }),\n});\n"],"names":["MARK_BOLD","createBoldPlugin","createPluginFactory","key","isLeaf","deserializeHtml","rules","validNodeName","validStyle","fontWeight","query","el","someHtmlElement","node","style","handlers","onKeyDown","onKeyDownToggleMark","options","hotkey","ELEMENT_HR","isElement","isVoid","deserializeMd","editor","data","tree","unified","use","remarkParse","slate","nodeTypes","paragraph","getPluginType","ELEMENT_PARAGRAPH","block_quote","ELEMENT_BLOCKQUOTE","link","ELEMENT_LINK","inline_code_mark","MARK_CODE","emphasis_mark","MARK_ITALIC","strong_mark","delete_mark","MARK_STRIKETHROUGH","code_block","ELEMENT_CODE_BLOCK","thematic_break","ul_list","ELEMENT_UL","ol_list","ELEMENT_OL","listItem","ELEMENT_LI","heading","ELEMENT_H1","ELEMENT_H2","ELEMENT_H3","ELEMENT_H4","ELEMENT_H5","ELEMENT_H6","linkDestinationKey","processSync","result","filterBreaklines","item","text","KEY_DESERIALIZE_MD","createDeserializeMdPlugin","then","insertData","format","dataTransfer","htmlData","getData","files","length","isUrl","getFragment"],"mappings":"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"}